import{u as x}from"./use-quasar.967395eb.js";import{i as C,_ as U,a4 as $,r as A,bD as Q,$ as q,o as c,c as b,w as R,a as i,b as D,a0 as j,a1 as L,e as m,a9 as k,a5 as r,aD as S,aK as M,aa as I,a8 as w,bE as B,bF as E,aC as F,t as N,g as v,a3 as O}from"./index.66a65c15.js";import{Q as P}from"./QSelect.6fdaa0a2.js";import{_ as T}from"./plugin-vue_export-helper.21dcd24c.js";import{c as K,a as z}from"./index.esm.3ac0c307.js";import{u as G,a as H}from"./vee-validate.esm.06ebb446.js";import"./QItemLabel.de72d5e0.js";import"./selection.8299b8f1.js";import"./rtl.b51694b1.js";const J=p=>(B("data-v-297085aa"),p=p(),E(),p),W={class:"flex flex-col gap-2 mt-2"},X=["onClick"],Y=J(()=>i("i",{class:"text-md fas fa-trash-alt"},null,-1)),Z=[Y],ee=C({__name:"model-dialog",props:["show","model"],emits:["closeDialog"],setup(p,{emit:_}){const g=p;x();const h=U(),e=$(),t=A({entity:structuredClone(Q(g.model)),types:["string","number","boolean"]});for(let o of e.project.modules)for(let s of o.models)t.types.push(o.name+"."+s.name);function y(){t.entity.properies.push(new M.PropertyModel({decorator:{name:"OriProps",data:{isRequired:!1}},isArray:!1,name:"prop"+(t.entity.properies.length+1)}))}function f(o){t.entity.properies.splice(o,1)}function d(){_("closeDialog")}async function u(){const o=e.project.modules.find(s=>s.name==h.params.name);if(o!=null){const s=o==null?void 0:o.models.findIndex(n=>n.name==g.model.name);s!=-1?(o.models[s]=t.entity,await I.save(e.project),w.success("Model was updated successfully."),d()):w.error("Model was not found!")}}return(o,s)=>{const n=q("Dialog");return c(),b(n,{show:g.show,title:"Model detail",onCloseDialog:d,onConfirmDialog:u},{default:R(()=>[i("button",{class:"btn btn-green",onClick:y},"Add"),i("div",W,[(c(!0),D(j,null,L(t.entity.properies,(a,V)=>(c(),D("div",{class:"model-card",key:V},[i("button",{class:"model-card-btn",onClick:l=>f(V)},Z,8,X),m(k,{modelValue:a.name,"onUpdate:modelValue":l=>a.name=l,outlined:"",dark:r(e).isDark,label:"Name"},null,8,["modelValue","onUpdate:modelValue","dark"]),m(k,{modelValue:a.defaultValue,"onUpdate:modelValue":l=>a.defaultValue=l,outlined:"",dark:r(e).isDark,label:"DefaultValue"},null,8,["modelValue","onUpdate:modelValue","dark"]),m(k,{modelValue:a.maxLength,"onUpdate:modelValue":l=>a.maxLength=l,outlined:"",dark:r(e).isDark,label:"Max Length"},null,8,["modelValue","onUpdate:modelValue","dark"]),m(k,{modelValue:a.minLength,"onUpdate:modelValue":l=>a.minLength=l,outlined:"",dark:r(e).isDark,label:"Min Length"},null,8,["modelValue","onUpdate:modelValue","dark"]),m(S,{label:"Required",dark:r(e).isDark,modelValue:a.decorator.data.isRequired,"onUpdate:modelValue":l=>a.decorator.data.isRequired=l},null,8,["dark","modelValue","onUpdate:modelValue"]),m(S,{label:"Array",dark:r(e).isDark,modelValue:a.isArray,"onUpdate:modelValue":l=>a.isArray=l},null,8,["dark","modelValue","onUpdate:modelValue"]),m(P,{outlined:"",dark:r(e).isDark,modelValue:a.type,"onUpdate:modelValue":l=>a.type=l,options:t.types,label:"Class Type"},null,8,["dark","modelValue","onUpdate:modelValue","options"]),m(k,{modelValue:a.description,"onUpdate:modelValue":l=>a.description=l,outlined:"",dark:r(e).isDark,label:"Description"},null,8,["modelValue","onUpdate:modelValue","dark"])]))),128))])]),_:1},8,["show"])}}});var oe=T(ee,[["__scopeId","data-v-297085aa"]]);const ae={key:0,class:"error"},le=C({__name:"add-model-dialog",props:["show"],emits:["closeDialog","reload"],setup(p,{emit:_}){const g=p;x();const h=$(),e=U(),t=A({schema:K({name:z().nullable("Model name is required!").required("Model name is required!")}),module:h.project.modules.filter(n=>n.name==e.params.name)[0]}),{handleSubmit:y,errors:f}=G({validationSchema:t.schema}),{value:d}=H("name");function u(){_("closeDialog")}async function o(){t.module.models||(t.module.models=[]);let n=new M.EntityModel({decorator:new M.DecoratorModel({name:"OriModel"})});n.name=d.value,t.module.models.push(n),await I.save(h.project),w.success("Model was added successfully!"),u()}async function s(){y(async()=>{await o()})()}return(n,a)=>{const V=q("Dialog");return c(),b(V,{show:g.show,title:"Add Model",onCloseDialog:u,onConfirmDialog:s},{default:R(()=>[m(k,{outlined:"",error:!!r(f).name,modelValue:r(d),"onUpdate:modelValue":a[0]||(a[0]=l=>F(d)?d.value=l:null),"hide-bottom-space":"",dark:r(h).isDark,label:"Model name",type:"text",class:"mt-3"},null,8,["error","modelValue","dark"]),r(f).name?(c(),D("span",ae,N(r(f).name),1)):v("",!0)]),_:1},8,["show"])}}}),se={class:"px-4 py-2 flex-between rounded-lg bg-gray-300 dark:bg-gray-700"},te=i("span",null,"Models:",-1),de={class:"flex items-center gap-1"},ne=["onClick"],re=["onClick"],ie=i("i",{class:"text-md fas fa-trash-alt"},null,-1),ue=[ie],ye=C({__name:"models",setup(p){const _=$(),g=U(),h=x(),e=A({module:_.project.modules.filter(d=>d.name==g.params.name)[0],showModelDialog:!1,showAddModelDialog:!1,selectedModel:null});function t(d,u){h.dialog({title:"Remove Model",message:"Are you sure you would like to remove this model?",dark:_.isDark,cancel:!0}).onOk(async()=>{var s,n;const o=(s=e.module)==null?void 0:s.models.findIndex(a=>a.name==d.name);o!=-1&&u==o&&((n=e.module)==null||n.models.splice(o,1),await I.save(_.project),w.success("Model was removed successfully."))})}function y(d,u){e.showModelDialog=!0,e.selectedModel=d}function f(){e.showAddModelDialog=!1,e.showModelDialog=!1,e.selectedModel=null}return(d,u)=>(c(),D("div",null,[i("div",se,[te,i("button",{class:"btn btn-green",onClick:u[0]||(u[0]=o=>e.showAddModelDialog=!0)}," Add model ")]),(c(!0),D(j,null,L(e.module.models,(o,s)=>(c(),D("div",{key:s,class:"px-4 py-2 mt-2 flex-between rounded-lg bg-gray-300 dark:bg-gray-700"},[i("span",null,[O("Service name: "),i("b",null,N(o.name),1)]),i("div",de,[i("button",{class:"btn btn-blue",onClick:n=>y(o)}," Detail ",8,ne),i("button",{class:"btn-squar btn-red",onClick:n=>t(o,s)},ue,8,re)])]))),128)),e.showModelDialog?(c(),b(oe,{key:0,show:e.showModelDialog,model:e.selectedModel,onCloseDialog:f},null,8,["show","model"])):v("",!0),e.showAddModelDialog?(c(),b(le,{key:1,show:e.showAddModelDialog,onCloseDialog:f},null,8,["show"])):v("",!0)]))}});export{ye as default};
